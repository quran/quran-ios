name: CI

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  Package:
    runs-on: macos-15

    steps:
    - uses: actions/checkout@v2

    - name: Setting up Xcode
      run: sudo xcode-select -s "/Applications/Xcode_26.1.1.app"

    - name: Install xcpretty
      run: gem install xcpretty

    - name: Run tests
      run: make test

    - uses: codecov/codecov-action@v4
      with:
        token: ${{ secrets.CODECOV_TOKEN }}

  ExampleApp:
    runs-on: macos-15

    steps:
      - uses: actions/checkout@v2

      - name: Setting up Xcode
        run: sudo xcode-select -s "/Applications/Xcode_26.1.1.app"

      - name: Install xcpretty
        run: gem install xcpretty
      
      - name: Build
        run: make build-example

  SwiftFormat:
    runs-on: macos-15

    steps:
      - uses: actions/checkout@v2

      - name: Setting up Xcode
        run: sudo xcode-select -s "/Applications/Xcode_26.1.1.app"
      
      - name: SwiftFormat
        run: make format-lint
